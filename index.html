<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucille's Premium Catering - CRM Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçΩÔ∏è</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Suppress Tailwind production warning for demo purposes
        if (typeof window !== 'undefined') {
            const originalWarn = console.warn;
            console.warn = function(...args) {
                if (args[0] && args[0].includes('tailwindcss.com should not be used in production')) {
                    return;
                }
                originalWarn.apply(console, args);
            };
        }
    </script>
    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7.23.0/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #f8fafc 0%, #faf5ff 50%, #fdf2f8 100%);
        }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .gradient-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .gradient-button:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // API Configuration - Users should replace this URL
        const API_CONFIG = {
            appsScriptUrl: 'YOUR_APPS_SCRIPT_URL_HERE' // User will replace this
        };

        // No sample data - connecting to real Google Sheets

        const { useState, useEffect } = React;

        // Icon components using Lucide
        const Icons = {
            Calendar: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.calendar.toSvg({ size }) } 
            }),
            Users: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.users.toSvg({ size }) } 
            }),
            TrendingUp: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.trendingUp.toSvg({ size }) } 
            }),
            DollarSign: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.dollarSign.toSvg({ size }) } 
            }),
            Bell: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.bell.toSvg({ size }) } 
            }),
            Search: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.search.toSvg({ size }) } 
            }),
            Filter: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.filter.toSvg({ size }) } 
            }),
            Mail: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.mail.toSvg({ size }) } 
            }),
            Phone: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.phone.toSvg({ size }) } 
            }),
            Gift: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.gift.toSvg({ size }) } 
            }),
            Heart: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.heart.toSvg({ size }) } 
            }),
            Briefcase: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.briefcase.toSvg({ size }) } 
            }),
            Award: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.award.toSvg({ size }) } 
            }),
            Baby: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.baby.toSvg({ size }) } 
            }),
            GraduationCap: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.graduationCap.toSvg({ size }) } 
            }),
            Star: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.star.toSvg({ size }) } 
            }),
            AlertCircle: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.alertCircle.toSvg({ size }) } 
            }),
            CheckCircle: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.checkCircle.toSvg({ size }) } 
            }),
            XCircle: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.xCircle.toSvg({ size }) } 
            }),
            Clock: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.clock.toSvg({ size }) } 
            }),
            ChevronDown: ({ size = 16 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.chevronDown.toSvg({ size }) } 
            }),
            Menu: ({ size = 24 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.menu.toSvg({ size }) } 
            }),
            X: ({ size = 24 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.x.toSvg({ size }) } 
            }),
            RefreshCw: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.refreshCw.toSvg({ size }) } 
            }),
            CalendarIcon: ({ size = 20 }) => React.createElement('i', { 
                dangerouslySetInnerHTML: { __html: lucide.icons.calendar.toSvg({ size }) } 
            })
        };

        // Utility functions
        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-PH', {
                style: 'currency',
                currency: 'PHP'
            }).format(amount);
        };

        const formatDate = (dateString) => {
            return new Date(dateString).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        };

        const getEventIcon = (eventType) => {
            switch (eventType) {
                case 'Wedding': return <Icons.Heart />;
                case 'Birthday Party': return <Icons.Gift />;
                case 'Corporate Event': return <Icons.Briefcase />;
                case 'Anniversary': return <Icons.Star />;
                case 'Baptism/Christening': return <Icons.Baby />;
                case 'Graduation': return <Icons.GraduationCap />;
                default: return <Icons.CalendarIcon />;
            }
        };

        const getStatusColor = (status) => {
            switch (status) {
                case 'Closed(Won)':
                case 'Closed':
                    return 'bg-green-100 text-green-800 border-green-200';
                case 'Pending':
                case 'Pending Follow-up':
                    return 'bg-yellow-100 text-yellow-800 border-yellow-200';
                case 'Lost':
                    return 'bg-red-100 text-red-800 border-red-200';
                default:
                    return 'bg-blue-100 text-blue-800 border-blue-200';
            }
        };

        const getStatusIcon = (status) => {
            switch (status) {
                case 'Closed(Won)':
                case 'Closed':
                    return <Icons.CheckCircle />;
                case 'Pending':
                case 'Pending Follow-up':
                    return <Icons.Clock />;
                case 'Lost':
                    return <Icons.XCircle />;
                default:
                    return <Icons.Clock />;
            }
        };

        // Data fetching functions
        const fetchLeads = async () => {
            try {
                if (API_CONFIG.appsScriptUrl === 'YOUR_APPS_SCRIPT_URL_HERE') {
                    throw new Error('Please configure your Google Apps Script URL');
                }
                const response = await fetch(`${API_CONFIG.appsScriptUrl}?action=getLeads`);
                if (!response.ok) throw new Error('Failed to fetch leads');
                return await response.json();
            } catch (error) {
                console.error('Error fetching leads:', error);
                throw error;
            }
        };

        const fetchDeals = async () => {
            try {
                if (API_CONFIG.appsScriptUrl === 'YOUR_APPS_SCRIPT_URL_HERE') {
                    throw new Error('Please configure your Google Apps Script URL');
                }
                const response = await fetch(`${API_CONFIG.appsScriptUrl}?action=getDeals`);
                if (!response.ok) throw new Error('Failed to fetch deals');
                return await response.json();
            } catch (error) {
                console.error('Error fetching deals:', error);
                throw error;
            }
        };

        const fetchData = async () => {
            const [leads, deals] = await Promise.all([fetchLeads(), fetchDeals()]);
            return { leads, deals };
        };

        // Main App Component
        const App = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [leads, setLeads] = useState([]);
            const [deals, setDeals] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [dealFilter, setDealFilter] = useState('All Deals');
            const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [refreshing, setRefreshing] = useState(false);

            // Load data on component mount
            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                try {
                    setLoading(true);
                    setError(null);
                    const data = await fetchData();
                    setLeads(data.leads);
                    setDeals(data.deals);
                } catch (err) {
                    setError(err.message);
                } finally {
                    setLoading(false);
                }
            };

            const handleRefresh = async () => {
                setRefreshing(true);
                try {
                    await loadData();
                } catch (err) {
                    // Error handled in loadData
                } finally {
                    setRefreshing(false);
                }
            };

            // Calculate statistics
            const stats = {
                totalLeads: leads.length,
                closedDeals: deals.filter(deal => deal.status === 'Closed(Won)').length,
                pendingDeals: deals.filter(deal => deal.status === 'Pending').length,
                lostDeals: deals.filter(deal => deal.status === 'Lost').length,
                totalRevenue: deals.filter(deal => deal.status === 'Closed(Won)')
                    .reduce((sum, deal) => sum + deal.bookingAmount, 0),
                totalCommission: deals.filter(deal => deal.status === 'Closed(Won)')
                    .reduce((sum, deal) => sum + deal.commission, 0),
                conversionRate: deals.length > 0 ? 
                    (deals.filter(deal => deal.status === 'Closed(Won)').length / deals.length * 100).toFixed(1) : 0
            };

            // Filter functions
            const filteredLeads = leads.filter(lead => 
                lead.clientName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                lead.email.toLowerCase().includes(searchTerm.toLowerCase()) ||
                lead.refNumber.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const filteredDeals = dealFilter === 'All Deals' 
                ? deals 
                : deals.filter(deal => deal.status === dealFilter);

            const birthdayLeads = leads.filter(lead => {
                const birthDate = new Date(lead.dateOfBirth);
                return birthDate.getMonth() === selectedMonth;
            });

            const upcomingEvents = leads.filter(lead => {
                const eventDate = new Date(lead.eventDate);
                const today = new Date();
                const thirtyDaysFromNow = new Date(today.getTime() + (30 * 24 * 60 * 60 * 1000));
                return eventDate >= today && eventDate <= thirtyDaysFromNow;
            }).sort((a, b) => new Date(a.eventDate) - new Date(b.eventDate));

            const getDaysUntilEvent = (eventDate) => {
                const today = new Date();
                const event = new Date(eventDate);
                const diffTime = event - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 0) return { text: "Today", color: "bg-red-100 text-red-800" };
                if (diffDays === 1) return { text: "Tomorrow", color: "bg-red-100 text-red-800" };
                if (diffDays <= 7) return { text: `${diffDays} days`, color: "bg-red-100 text-red-800" };
                if (diffDays <= 14) return { text: `${diffDays} days`, color: "bg-yellow-100 text-yellow-800" };
                return { text: `${diffDays} days`, color: "bg-blue-100 text-blue-800" };
            };

            const months = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];

            // Tab components
            const tabs = [
                { id: 'dashboard', name: 'Dashboard', icon: <Icons.TrendingUp /> },
                { id: 'leads', name: 'Leads', icon: <Icons.Users /> },
                { id: 'deals', name: 'Deals', icon: <Icons.DollarSign /> },
                { id: 'birthdays', name: 'Birthdays', icon: <Icons.Gift /> },
                { id: 'events', name: 'Events', icon: <Icons.Calendar /> }
            ];

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="loading-spinner mx-auto mb-4">
                                <Icons.RefreshCw />
                            </div>
                            <p className="text-gray-600">Loading data from Google Sheets...</p>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <Icons.AlertCircle />
                            <h2 className="text-xl font-semibold text-gray-800 mb-2">Connection Error</h2>
                            <p className="text-gray-600 mb-4">{error}</p>
                            <button
                                onClick={handleRefresh}
                                className="gradient-button text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all duration-300"
                            >
                                Retry
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen">
                    {/* Header */}
                    <header className="bg-white shadow-lg sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center py-4">
                                {/* Logo */}
                                <div className="flex items-center space-x-4">
                                    <div className="w-12 h-12 rounded-full gradient-button flex items-center justify-center text-white font-bold text-xl">
                                        L
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold gradient-text">Lucille's Premium Catering</h1>
                                        <p className="text-sm text-gray-600">CRM Dashboard</p>
                                    </div>
                                </div>

                                {/* Desktop Navigation */}
                                <nav className="hidden md:flex space-x-8">
                                    {tabs.map(tab => (
                                        <button
                                            key={tab.id}
                                            onClick={() => setActiveTab(tab.id)}
                                            className={`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-300 ${
                                                activeTab === tab.id 
                                                    ? 'gradient-button text-white shadow-lg' 
                                                    : 'text-gray-600 hover:text-purple-600 hover:bg-gray-50'
                                            }`}
                                        >
                                            {tab.icon}
                                            <span>{tab.name}</span>
                                        </button>
                                    ))}
                                </nav>

                                {/* Refresh Button */}
                                <div className="flex items-center space-x-4">
                                    <button
                                        onClick={handleRefresh}
                                        disabled={refreshing}
                                        className="flex items-center space-x-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-300 disabled:opacity-50"
                                    >
                                        <div className={refreshing ? 'loading-spinner' : ''}>
                                            <Icons.RefreshCw />
                                        </div>
                                        <span className="hidden sm:inline">Refresh Data</span>
                                    </button>

                                    {/* Mobile Menu Button */}
                                    <button
                                        onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
                                        className="md:hidden p-2 rounded-lg text-gray-600 hover:bg-gray-100"
                                    >
                                        {mobileMenuOpen ? <Icons.X /> : <Icons.Menu />}
                                    </button>
                                </div>
                            </div>

                            {/* Mobile Navigation */}
                            {mobileMenuOpen && (
                                <div className="md:hidden pb-4">
                                    {tabs.map(tab => (
                                        <button
                                            key={tab.id}
                                            onClick={() => {
                                                setActiveTab(tab.id);
                                                setMobileMenuOpen(false);
                                            }}
                                            className={`flex items-center space-x-2 w-full px-4 py-3 rounded-lg transition-all duration-300 ${
                                                activeTab === tab.id 
                                                    ? 'gradient-button text-white shadow-lg' 
                                                    : 'text-gray-600 hover:text-purple-600 hover:bg-gray-50'
                                            }`}
                                        >
                                            {tab.icon}
                                            <span>{tab.name}</span>
                                        </button>
                                    ))}
                                </div>
                            )}
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* Dashboard Tab */}
                        {activeTab === 'dashboard' && (
                            <div className="space-y-8 fade-in">
                                {/* Stats Cards */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-sm font-medium text-gray-600">Total Leads</p>
                                                <p className="text-3xl font-bold text-blue-600">{stats.totalLeads}</p>
                                            </div>
                                            <div className="p-3 bg-blue-100 rounded-xl">
                                                <Icons.Users />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-sm font-medium text-gray-600">Closed Deals</p>
                                                <p className="text-3xl font-bold text-green-600">{stats.closedDeals}</p>
                                                <p className="text-xs text-gray-500">{stats.conversionRate}% conversion</p>
                                            </div>
                                            <div className="p-3 bg-green-100 rounded-xl">
                                                <Icons.CheckCircle />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-sm font-medium text-gray-600">Total Revenue</p>
                                                <p className="text-3xl font-bold text-purple-600">{formatCurrency(stats.totalRevenue)}</p>
                                            </div>
                                            <div className="p-3 bg-purple-100 rounded-xl">
                                                <Icons.DollarSign />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-sm font-medium text-gray-600">Your Commission</p>
                                                <p className="text-3xl font-bold text-pink-600">{formatCurrency(stats.totalCommission)}</p>
                                                <p className="text-xs text-gray-500">5% of closed deals</p>
                                            </div>
                                            <div className="p-3 bg-pink-100 rounded-xl">
                                                <Icons.TrendingUp />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Quick Stats */}
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">Deal Pipeline</h3>
                                        <div className="space-y-3">
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center space-x-2">
                                                    <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                                                    <span className="text-sm text-gray-600">Closed Won</span>
                                                </div>
                                                <span className="font-semibold text-gray-800">{stats.closedDeals}</span>
                                            </div>
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center space-x-2">
                                                    <div className="w-3 h-3 bg-yellow-500 rounded-full"></div>
                                                    <span className="text-sm text-gray-600">Pending</span>
                                                </div>
                                                <span className="font-semibold text-gray-800">{stats.pendingDeals}</span>
                                            </div>
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center space-x-2">
                                                    <div className="w-3 h-3 bg-red-500 rounded-full"></div>
                                                    <span className="text-sm text-gray-600">Lost</span>
                                                </div>
                                                <span className="font-semibold text-gray-800">{stats.lostDeals}</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">Upcoming Events</h3>
                                        <div className="text-center">
                                            <p className="text-3xl font-bold text-blue-600">{upcomingEvents.length}</p>
                                            <p className="text-sm text-gray-600">Next 30 days</p>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">This Month's Birthdays</h3>
                                        <div className="text-center">
                                            <p className="text-3xl font-bold text-pink-600">{birthdayLeads.length}</p>
                                            <p className="text-sm text-gray-600">Re-booking opportunities</p>
                                        </div>
                                    </div>
                                </div>

                                {/* Recent Activity */}
                                <div className="bg-white rounded-2xl shadow-lg p-6">
                                    <h3 className="text-lg font-semibold text-gray-800 mb-6">Recent Activity</h3>
                                    {leads.slice(0, 5).map(lead => (
                                        <div key={lead.refNumber} className="flex items-center space-x-4 py-4 border-b border-gray-100 last:border-b-0">
                                            <div className="p-2 bg-gray-100 rounded-lg">
                                                {getEventIcon(lead.eventType)}
                                            </div>
                                            <div className="flex-1">
                                                <p className="font-medium text-gray-800">{lead.clientName}</p>
                                                <p className="text-sm text-gray-600">{lead.eventType} ‚Ä¢ {formatDate(lead.eventDate)}</p>
                                            </div>
                                            <span className={`px-3 py-1 rounded-full text-xs font-medium border ${getStatusColor(lead.status)}`}>
                                                {lead.status}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Leads Tab */}
                        {activeTab === 'leads' && (
                            <div className="space-y-6 fade-in">
                                {/* Search Bar */}
                                <div className="bg-white rounded-2xl shadow-lg p-6">
                                    <div className="relative">
                                        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <Icons.Search />
                                        </div>
                                        <input
                                            type="text"
                                            placeholder="Search by name, email, or reference number..."
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500"
                                        />
                                    </div>
                                    {searchTerm && (
                                        <p className="mt-2 text-sm text-gray-600">
                                            Found {filteredLeads.length} result{filteredLeads.length !== 1 ? 's' : ''}
                                        </p>
                                    )}
                                </div>

                                {/* Leads Grid */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {filteredLeads.map(lead => (
                                        <div key={lead.refNumber} className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                            <div className="flex justify-between items-start mb-4">
                                                <div>
                                                    <h3 className="font-semibold text-gray-800">{lead.clientName}</h3>
                                                    <p className="text-sm text-gray-600">{lead.refNumber}</p>
                                                </div>
                                                <span className={`flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium border ${getStatusColor(lead.status)}`}>
                                                    {getStatusIcon(lead.status)}
                                                    <span>{lead.status}</span>
                                                </span>
                                            </div>

                                            <div className="space-y-3">
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    <Icons.Mail />
                                                    <a href={`mailto:${lead.email}`} className="hover:text-purple-600 transition-colors">
                                                        {lead.email}
                                                    </a>
                                                </div>
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    <Icons.Phone />
                                                    <a href={`tel:${lead.phone}`} className="hover:text-purple-600 transition-colors">
                                                        {lead.phone}
                                                    </a>
                                                </div>
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    <Icons.CalendarIcon />
                                                    <span>{formatDate(lead.eventDate)}</span>
                                                </div>
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    {getEventIcon(lead.eventType)}
                                                    <span>{lead.eventType}</span>
                                                </div>
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    <Icons.Users />
                                                    <span>{lead.numberOfGuests} guests</span>
                                                </div>
                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                    <Icons.Gift />
                                                    <span>{formatDate(lead.dateOfBirth)}</span>
                                                </div>
                                            </div>

                                            {lead.message && (
                                                <div className="mt-4 p-3 bg-gray-50 rounded-lg">
                                                    <p className="text-sm text-gray-700">{lead.message}</p>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>

                                {filteredLeads.length === 0 && (
                                    <div className="text-center py-12">
                                        <Icons.Users />
                                        <h3 className="text-lg font-semibold text-gray-800 mb-2">No leads found</h3>
                                        <p className="text-gray-600">No leads match your search criteria.</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Deals Tab */}
                        {activeTab === 'deals' && (
                            <div className="space-y-6 fade-in">
                                {/* Filter Dropdown */}
                                <div className="bg-white rounded-2xl shadow-lg p-6">
                                    <div className="flex items-center space-x-4">
                                        <Icons.Filter />
                                        <select
                                            value={dealFilter}
                                            onChange={(e) => setDealFilter(e.target.value)}
                                            className="border border-gray-300 rounded-lg px-4 py-2 focus:ring-purple-500 focus:border-purple-500"
                                        >
                                            <option>All Deals</option>
                                            <option>Closed(Won)</option>
                                            <option>Pending</option>
                                            <option>Lost</option>
                                        </select>
                                        <span className="text-sm text-gray-600">
                                            Showing {filteredDeals.length} deal{filteredDeals.length !== 1 ? 's' : ''}
                                        </span>
                                    </div>
                                </div>

                                {/* Deals Grid */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {filteredDeals.map((deal, index) => (
                                        <div key={`${deal.refNumber}-${index}`} className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                            <div className="flex justify-between items-start mb-4">
                                                <div>
                                                    <h3 className="font-semibold text-gray-800">{deal.refNumber}</h3>
                                                    <p className="text-sm text-gray-600">{deal.timestamp}</p>
                                                </div>
                                                <span className={`flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium border ${getStatusColor(deal.status)}`}>
                                                    {getStatusIcon(deal.status)}
                                                    <span>{deal.status}</span>
                                                </span>
                                            </div>

                                            <div className="grid grid-cols-1 gap-4 mb-4">
                                                <div className="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg">
                                                    <p className="text-sm text-blue-600 font-medium">Booking Amount</p>
                                                    <p className="text-2xl font-bold text-blue-800">{formatCurrency(deal.bookingAmount)}</p>
                                                </div>

                                                <div className="bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg">
                                                    <p className="text-sm text-purple-600 font-medium">Commission (5%)</p>
                                                    <p className="text-xl font-bold text-purple-800">{formatCurrency(deal.commission)}</p>
                                                </div>

                                                <div className="bg-gradient-to-r from-pink-50 to-pink-100 p-4 rounded-lg">
                                                    <p className="text-sm text-pink-600 font-medium">Status</p>
                                                    <p className="text-lg font-bold text-pink-800">
                                                        {deal.latestEntry ? 'Latest' : 'Historical'}
                                                    </p>
                                                </div>
                                            </div>

                                            {deal.notes && (
                                                <div className="p-3 bg-gray-50 rounded-lg">
                                                    <p className="text-sm text-gray-700">{deal.notes}</p>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>

                                {filteredDeals.length === 0 && (
                                    <div className="text-center py-12">
                                        <Icons.DollarSign />
                                        <h3 className="text-lg font-semibold text-gray-800 mb-2">No deals found</h3>
                                        <p className="text-gray-600">No deals match your filter criteria.</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Birthdays Tab */}
                        {activeTab === 'birthdays' && (
                            <div className="space-y-6 fade-in">
                                {/* Month Selector */}
                                <div className="bg-white rounded-2xl shadow-lg p-6">
                                    <div className="flex items-center space-x-4">
                                        <Icons.CalendarIcon />
                                        <select
                                            value={selectedMonth}
                                            onChange={(e) => setSelectedMonth(parseInt(e.target.value))}
                                            className="border border-gray-300 rounded-lg px-4 py-2 focus:ring-purple-500 focus:border-purple-500"
                                        >
                                            {months.map((month, index) => (
                                                <option key={index} value={index}>{month}</option>
                                            ))}
                                        </select>
                                        <span className="text-sm text-gray-600">
                                            {birthdayLeads.length} birthday{birthdayLeads.length !== 1 ? 's' : ''} in {months[selectedMonth]}
                                        </span>
                                    </div>
                                </div>

                                {/* Header Card */}
                                <div className="bg-gradient-to-r from-pink-500 to-purple-600 rounded-2xl shadow-lg p-8 text-white">
                                    <div className="flex items-center space-x-4">
                                        <div className="p-4 bg-white bg-opacity-20 rounded-2xl">
                                            <Icons.Gift />
                                        </div>
                                        <div>
                                            <h2 className="text-3xl font-bold">{birthdayLeads.length} Birthdays</h2>
                                            <p className="text-pink-100">Re-booking opportunities this month</p>
                                            <p className="text-sm text-pink-200 mt-2">
                                                Reach out to these clients and offer them a special birthday package!
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                {/* Birthday Cards */}
                                {birthdayLeads.length > 0 ? (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        {birthdayLeads.map(lead => {
                                            const birthDate = new Date(lead.dateOfBirth);
                                            const monthName = months[birthDate.getMonth()];
                                            const day = birthDate.getDate();
                                            
                                            return (
                                                <div key={lead.refNumber} className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                                    <div className="flex items-center space-x-4 mb-4">
                                                        <div className="p-3 bg-gradient-to-r from-pink-500 to-purple-600 rounded-xl text-white">
                                                            <Icons.Gift />
                                                        </div>
                                                        <div>
                                                            <h3 className="text-lg font-bold text-gray-800">{lead.clientName}</h3>
                                                            <p className="text-sm text-gray-600">Birthday on {monthName} {day}</p>
                                                        </div>
                                                    </div>

                                                    <div className="space-y-3">
                                                        <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                            <Icons.Mail />
                                                            <a href={`mailto:${lead.email}`} className="hover:text-purple-600 transition-colors">
                                                                {lead.email}
                                                            </a>
                                                        </div>
                                                        <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                            <Icons.Phone />
                                                            <a href={`tel:${lead.phone}`} className="hover:text-purple-600 transition-colors">
                                                                {lead.phone}
                                                            </a>
                                                        </div>
                                                    </div>

                                                    <button className="w-full mt-4 gradient-button text-white py-2 px-4 rounded-lg hover:shadow-lg transition-all duration-300">
                                                        Send Message
                                                    </button>
                                                </div>
                                            );
                                        })}
                                    </div>
                                ) : (
                                    <div className="text-center py-12">
                                        <div className="w-16 h-16 mx-auto mb-4 text-gray-400">
                                            <Icons.Gift />
                                        </div>
                                        <h3 className="text-lg font-semibold text-gray-800 mb-2">No Birthdays This Month</h3>
                                        <p className="text-gray-600">Select a different month to view birthday reminders</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Events Tab */}
                        {activeTab === 'events' && (
                            <div className="space-y-6 fade-in">
                                {/* Header */}
                                <div className="bg-white rounded-2xl shadow-lg p-6">
                                    <div className="flex items-center justify-between">
                                        <h2 className="text-2xl font-bold text-gray-800">Upcoming Events</h2>
                                        <span className="px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full text-sm font-medium">
                                            Next 30 Days
                                        </span>
                                    </div>
                                    <p className="text-gray-600 mt-2">
                                        {upcomingEvents.length} event{upcomingEvents.length !== 1 ? 's' : ''} scheduled
                                    </p>
                                </div>

                                {/* Events List */}
                                {upcomingEvents.length > 0 ? (
                                    <div className="space-y-4">
                                        {upcomingEvents.map(lead => {
                                            const eventDate = new Date(lead.eventDate);
                                            const day = eventDate.getDate();
                                            const month = eventDate.toLocaleDateString('en-US', { month: 'short' }).toUpperCase();
                                            const daysUntil = getDaysUntilEvent(lead.eventDate);
                                            
                                            return (
                                                <div key={lead.refNumber} className="bg-white rounded-2xl shadow-lg p-6 card-hover">
                                                    <div className="flex items-start space-x-6">
                                                        {/* Date Box */}
                                                        <div className="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl p-4 text-center min-w-[80px]">
                                                            <div className="text-2xl font-bold">{day}</div>
                                                            <div className="text-xs uppercase">{month}</div>
                                                        </div>

                                                        {/* Event Details */}
                                                        <div className="flex-1">
                                                            <div className="flex items-start justify-between mb-4">
                                                                <div>
                                                                    <h3 className="text-lg font-bold text-gray-800">{lead.clientName}</h3>
                                                                    <p className="text-sm text-gray-600">{lead.refNumber}</p>
                                                                </div>
                                                                <span className={`px-3 py-1 rounded-full text-xs font-medium ${daysUntil.color}`}>
                                                                    {daysUntil.text}
                                                                </span>
                                                            </div>

                                                            <div className="flex items-center space-x-2 mb-4">
                                                                <div className="p-2 bg-purple-100 rounded-lg text-purple-600">
                                                                    {getEventIcon(lead.eventType)}
                                                                </div>
                                                                <span className="font-medium text-gray-800">{lead.eventType}</span>
                                                            </div>

                                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                                    <Icons.Users />
                                                                    <span>{lead.numberOfGuests} guests</span>
                                                                </div>
                                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                                    <Icons.Mail />
                                                                    <a href={`mailto:${lead.email}`} className="hover:text-purple-600 transition-colors truncate">
                                                                        {lead.email}
                                                                    </a>
                                                                </div>
                                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                                    <Icons.Phone />
                                                                    <a href={`tel:${lead.phone}`} className="hover:text-purple-600 transition-colors">
                                                                        {lead.phone}
                                                                    </a>
                                                                </div>
                                                                <div className="flex items-center space-x-2 text-sm text-gray-600">
                                                                    <Icons.CalendarIcon />
                                                                    <span>{formatDate(lead.eventDate)}</span>
                                                                </div>
                                                            </div>

                                                            {lead.message && (
                                                                <div className="p-3 bg-gray-50 rounded-lg">
                                                                    <p className="text-sm text-gray-700">{lead.message}</p>
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                ) : (
                                    <div className="text-center py-12">
                                        <div className="w-16 h-16 mx-auto mb-4 text-gray-400">
                                            <Icons.CalendarIcon size={64} />
                                        </div>
                                        <h3 className="text-lg font-semibold text-gray-800 mb-2">No Upcoming Events</h3>
                                        <p className="text-gray-600">No events scheduled for the next 30 days</p>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t border-gray-200 mt-16">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                            <div className="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
                                <div className="text-gray-600">
                                    Lucille's Premium Catering CRM System
                                </div>
                                <div className="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4">
                                    <div className="text-sm text-gray-600">
                                        Developer: Jethro Bermejo
                                    </div>
                                    <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                                        API_CONFIG.appsScriptUrl === 'YOUR_APPS_SCRIPT_URL_HERE' 
                                            ? 'bg-red-100 text-red-800' 
                                            : 'bg-green-100 text-green-800'
                                    }`}>
                                        {API_CONFIG.appsScriptUrl === 'YOUR_APPS_SCRIPT_URL_HERE' 
                                            ? 'Not Configured' 
                                            : 'Connected to Google Sheets'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </footer>

                    {/* Setup Instructions Modal */}
                    {API_CONFIG.appsScriptUrl === 'YOUR_APPS_SCRIPT_URL_HERE' && (
                        <div className="fixed bottom-4 right-4 max-w-sm">
                            <div className="bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg">
                                <h4 className="font-semibold text-red-800 mb-2">‚ö†Ô∏è Configuration Required</h4>
                                <ol className="text-sm text-red-700 space-y-1">
                                    <li>1. Set up your Google Sheets with required columns</li>
                                    <li>2. Deploy your Google Apps Script as a web app</li>
                                    <li>3. Replace 'YOUR_APPS_SCRIPT_URL_HERE' with your URL</li>
                                    <li>4. Refresh to load your data</li>
                                </ol>
                                <p className="text-xs text-red-600 mt-2">See DEPLOYMENT.md for detailed instructions</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
